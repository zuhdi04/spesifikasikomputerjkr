<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Staf - ADMIN</title>
    <link rel="stylesheet" href="css/mystyle.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body>
    <div class="top-bar">
        <img class="icon" src="img/logo.png" alt="Avatar" width="100px" height="100px">
        <a onclick="alert('You are going to logout')" class="logout" href="login.html">Logout</a>
    </div>

    <!-- Navigation Menu -->
    <nav class="menu-bar">
        <ul>
            <li><a href="ADMIN-staff_details.html">Admin</a></li>
            <li><a href="ADMIN-unit_details.html">Unit</a></li>
            <li><a href="ADMIN-computer_details.html">Details</a></li>
        </ul>
    </nav>

    <div class="content">
        <div class="form-container">
            <h1>SPESIFIKASI KOMPUTER KAKITANGAN JKR KEDAH BAHAGIAN/UNIT/DAERAH: UNIT PENTADBIRAN & KEWANGAN</h1>
            <h2>Admin Management</h2>
            <form class="form-container" method="POST" action="addAdminList.php" id="admin-form">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter Username" required>

                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter Password" required>

                <label for="cawangan">Cawangan</label>
                <input type="text" id="cawangan" name="cawangan" placeholder="Enter Cawangan" required>

                <button type="submit" name="addadmin" class="btnAdd">Add Admin</button><br>
            </form>

            <div class="admin-list" id="admin-list">
                <h2>Admin Accounts</h2>
                <!-- Admin items will appear here -->
                <table id="staffTable" class="display" border="display">
                    <thead>
                        <tr>
                            <th>USERNAME</th>
                            <th>PASS</th>
                            <th>CAWANGAN/ DAERAH/ UNIT/ BAHAGIAN</th>
                            <th>OPERASI</th>
                        </tr>
                    </thead>
                    <tbody id="stafflist">
                        <!-- <tr>
                            <td>1</td>
                        </tr> -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
        // Handle form submission
        const adminForm = document.getElementById('admin-form');
        // const adminList = document.getElementById('admin-list');

        adminForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const cawangan = document.getElementById('cawangan').value;

        //     if (username && password && cawangan) {
        //         // Create a new admin item
        //         const adminItem = document.createElement('div');
        //         adminItem.classList.add('admin-item');
        //         adminItem.innerHTML = `
        //   <span><strong>Username:</strong> ${username} | <strong>Cawangan:</strong> ${cawangan}</span>
        //   <button class="delete-btn">Delete</button>
        // `;

        //         // Add delete functionality
        //         adminItem.querySelector('.delete-btn').addEventListener('click', function () {
        //             adminList.removeChild(adminItem);
        //         });

        //         // Append to the list
        //         adminList.appendChild(adminItem);

        //         // Clear the form
        //         adminForm.reset();
        //     }
            $.ajax({
                url: 'checkstaffList.php?content='+username, // Replace with your API endpoint
                method: 'GET',
                success: function(response) {
                    if(response!=""){ // use "response" for single variable 
                        // or use "item = JSON.parse(response)" for multiple variable
                        // let item =  JSON.parse(response);
                        
                        if(response==null)
                            adminForm.submit();
                        else {
                            alert("Username telah ada!")
                        }
                    }
                    else{
                    }
                },
                
                error: function(jqXHR, textStatus, errorThrown) {
                    // document.getElementById('username').innerHTML="";
                }
            });
        });
    </script>
    
    <!-- <script src="js/dashboard.js"></script> -->
    <script src="js/pagecookie.js"></script>

    <script src="js/myAlert.js"></script>
    
    <script>
    showAlert();
    function details(){
    $.ajax({
        url: 'allAdminList.php', // Replace with your API endpoint
        method: 'GET',
        success: function(response) {
            if(response!=""){ // use "response" for single variable 
                // or use "item = JSON.parse(response)" for multiple variable
                console.log(response);
                
                // let item =  JSON.parse(response);
                
                response.forEach(item => {
                    $('#stafflist').append(`
                        <tr>
                            <td>`+item.username+`</td>
                            <td></td>
                            <td>`+item.nama+`</td>
                            <td><a href="staff-edit.php?form=`+item.id+`" onclick="return false">Edit</a>
                            <a href="delete" class="delete_details" data-name="`+item.username+`" onclick="return false;">Delete</a></td>
                        </tr>`);
                });
            }
            else{
            }
        },
        
        error: function(jqXHR, textStatus, errorThrown) {
            // document.getElementById('username').innerHTML="";
        }
    });}
    details();
    </script>
</body>

</html>